<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>고객 관리 - 무인상점</title>
    <!-- 구글 폰트 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet" />
    <!-- Bootstrap -->
    <link href="bootstrap-4.6.2-dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- 공통 스타일 -->
    <link href="CSS/common.css" rel="stylesheet" />
    <!-- 대시보드 스타일 -->
    <link href="CSS/Dashboard.css" rel="stylesheet" />
    <!-- 고객관리 전용 스타일 -->
    <link href="CSS/customers.css" rel="stylesheet" />
</head>

<body>
    <!-- 사이드바 -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-brand">
            <i class="fas fa-store"></i>
            <h2>무인 매장 관리</h2>
        </div>
        <nav>
            <a href="index.html" class="nav-link"><i class="fas fa-home"></i>대시보드</a>
            <a href="products.html" class="nav-link"><i class="fas fa-boxes"></i>상품 관리</a>
            <a href="orders.html" class="nav-link"><i class="fas fa-shopping-cart"></i>주문 관리</a>
            <a href="inventory.html" class="nav-link"><i class="fas fa-warehouse"></i>재고 관리</a>
            <a href="sales.html" class="nav-link"><i class="fas fa-chart-line"></i>매출 분석</a>
            <a href="customers.html" class="nav-link active"><i class="fas fa-users"></i>고객 관리</a>
        </nav>
    </aside>

    <!-- 메인 컨테이너 -->
    <div class="main-container">
        <!-- 헤더 -->
        <header class="header d-flex justify-content-between align-items-center">
            <button id="mobileMenuBtn" class="mobile-menu-btn"><i class="fas fa-bars"></i></button>
            <h1 class="header-title">고객 관리</h1>
            <div class="user-info">
                <button class="notification-btn"><i class="fas fa-bell"></i><span
                        class="notification-badge">3</span></button>
                <span>관리자님</span>
            </div>
        </header>

        <!-- 본문 -->
        <main class="main-content container-fluid py-4">
            <!-- KPI 섹션 -->
            <section class="row g-4 mb-4" id="kpiSection">
                <div class="col-md-3">
                    <div class="card kpi-card">
                        <p class="kpi-title">총 고객 수</p>
                        <h3 id="kpiTotalCustomers" class="kpi-value">2명</h3>
                        <p id="kpiNewCustomerChange" class="kpi-change">▲0%</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card kpi-card">
                        <p class="kpi-title">신규 고객(30일)</p>
                        <h3 id="kpiNewCustomers" class="kpi-value">0명</h3>
                        <p id="kpiNewCustChange" class="kpi-change">▲0%</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card kpi-card">
                        <p class="kpi-title">평균 구매액</p>
                        <h3 id="kpiAvgPurchase" class="kpi-value">₩0</h3>
                        <p id="kpiAvgChange" class="kpi-change">▲0%</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card kpi-card">
                        <p class="kpi-title">재구매율</p>
                        <h3 id="kpiRepurchase" class="kpi-value">0%</h3>
                        <p id="kpiRepurchaseChange" class="kpi-change">▲0%</p>
                    </div>
                </div>
            </section>

            <!-- 차트 섹션 -->
            <section class="row g-4 mb-4">
                <div class="col-lg-6">
                    <div class="card chart-card">
                        <h5 class="chart-title">가입자 추이</h5>
                        <canvas id="signupChart"></canvas>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card chart-card">
                        <h5 class="chart-title">등급 비율</h5>
                        <canvas id="segmentChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- 컨트롤 섹션 -->
            <div class="controls mb-4">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input id="searchInput" type="text" class="form-control" placeholder="고객명 또는 연락처 검색…" />
                </div>
                <select id="segmentFilter" class="form-select filter-select">
                    <option value="all">전체 등급</option>
                    <option value="vip">VIP</option>
                    <option value="normal">일반</option>
                    <option value="inactive">비활성</option>
                </select>
                <input id="dateRange" class="form-control filter-date" placeholder="가입일자" />
                <button id="exportCsvBtn" class="btn btn-outline-secondary add-btn"><i
                        class="fas fa-file-csv me-1"></i>CSV 내보내기</button>
                <button id="importBtn" class="btn btn-outline-secondary"><i class="fas fa-file-import me-1"></i>CSV
                    가져오기</button>
                <input type="file" id="importFileInput" style="display:none;" />
            </div>

            <!-- 고객 목록 테이블 -->
            <div class="table-responsive mb-4">
                <table class="table table-hover align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>고객명</th>
                            <th>연락처</th>
                            <th>이메일</th>
                            <th>가입일</th>
                            <th>주문 건수</th>
                            <th>총 구매액</th>
                            <th>등급</th>
                            <th>관리</th>
                        </tr>
                    </thead>
                    <tbody id="customersTableBody"><!-- JS 로딩 --></tbody>
                </table>
            </div>

            <!-- 고객 상세 모달 -->
            <div id="customerModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 id="modalCustomerName">홍길동</h5>
                        <button class="close-btn" id="closeCustomerModal"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="modal-body">
                        <p><strong>전화:</strong> <span id="modalPhone"></span></p>
                        <p><strong>이메일:</strong> <span id="modalEmail"></span></p>
                        <p><strong>주소:</strong> <span id="modalAddress"></span></p>
                        <hr />
                        <h6>최근 주문</h6>
                        <table class="table table-sm mb-3">
                            <thead>
                                <tr>
                                    <th>주문번호</th>
                                    <th>날짜</th>
                                    <th>금액</th>
                                </tr>
                            </thead>
                            <tbody id="modalRecentOrders"></tbody>
                        </table>
                        <hr />
                        <h6>활동 기록</h6>
                        <ul id="activityLog" class="list-unstyled small mb-3"></ul>
                        <hr />
                        <h6>태그 / 메모</h6>
                        <div id="tagContainer" class="mb-2"></div>
                        <div class="input-group">
                            <input type="text" id="newTagInput" class="form-control" placeholder="새 태그 추가…" />
                            <button id="addTagBtn" class="btn btn-outline-primary">추가</button>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- 스크립트 -->
    <script src="bootstrap-4.6.2-dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="Chart/chart.umd.js"></script>
    <script src="JS/common.js"></script>
    <script src="JS/customers.js"></script>
</body>

</html>